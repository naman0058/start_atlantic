<%- include ('./adminheader.ejs') %>



<!--InsertDiv-->


  <div class="container-fluid mt--7">
      <div id="insertdiv">
    <div class="row">
      <div class="col-xl-12 order-xl-1">
        <div class="card bg-secondary shadow">
            <div class="card-header bg-white border-0">
                <div class="row align-items-center">
                  <div class="col-8">
                    <h3 class="mb-0">Show Report</h3>
                  </div>
                 
                </div>
              </div>
              
          <div class="card-body">
              <div class="pl-lg-4">
              
                    <div class="row">
                      <div class="col-lg-6">
                        <div class="form-group">
                          <label class="form-control-label" for="input-username">From Date</label>
                          <input type="date" id="from_date" name="name" class="form-control form-control-alternative"
                            placeholder="Name">
                        </div>
                      </div>

                      <div class="col-lg-6">
                        <div class="form-group">
                          <label class="form-control-label" for="input-email">To Date</label>
                          <input type="date" id="to_date" name="number" class="form-control form-control-alternative"
                            placeholder="Mobile Number">
                        </div>
                      </div>
                    </div>
                  
                <div class="row">
                  <div class="col-md-12">
                    <div class="form-group">
                      <button type="button" id="button" class="btn btn-info save">Search </button>
                    </div>
                  </div>
                </div>
           </div>
        </div>
      </div>
    </div>
 </div>
</div>

<!--End InsertDiv-->

<div id="result"></div>
<!--EditDiv-->


 


<!--Ends EditDiv-->

<!--UpdateImageDiv Start-->

      </div>
  
  
      <!-- Footer -->
      <footer class="footer">
        <div class="row align-items-center justify-content-xl-between">
          <div class="col-xl-6">
            
          </div>
        
        </div>
      </footer>
    </div>
  </div>
  <!-- Argon Scripts -->
  <!-- Core -->
  <script src="/admin/assets/vendor/jquery/dist/jquery.min.js"></script>
  <script src="/admin/assets/vendor/bootstrap/dist/js/bootstrap.bundle.min.js"></script>
  <!-- Argon JS -->
  <script src="/admin/assets/js/argon.js?v=1.0.0"></script>


  <script src="https://cdn.jsdelivr.net/gh/linways/table-to-excel@v1.0.4/dist/tableToExcel.js"></script>


<script>

    $('#button').click(function(){
        if ($('#from_date').val() == '' ||  $('#from_date').val() == [] ) alert('Select From Date');
else if ($('#to_date').val() == '' ||  $('#to_date').val() == [] ) alert('Select To Date');
else {
    let from_date = $('#from_date').val()
    let to_date = $('#to_date').val()

    $.post('/show-reports',{from_date,to_date},data=>{
      makeTable(data)
    })

}
    })






    function makeTable(board){
    let table = ` <div class="row mt-5">
    <div class="col">
      <div class="card bg-default shadow">
        <div class="card-header bg-transparent border-0">
          <h3 class="text-white mb-0">Enquiry List
            <button type="button" class="btn btn-primary float-right" id="exportBtn1" style="float: right;">Export Data</button>
            
            </h3>
          <br>
          <button type="button" id="back" class="btn btn-sm btn-primary">BacK</button>
        </div>
       
      
      
        <div class="table-responsive">
          <table class="table align-items-center table-dark table-flush" id='tab1'>
            <thead class="thead-dark">
              <tr>

                <th scope="col">S.No.</th>

                
                <th scope="col">Event Name</th>

                <th scope="col">Vendor Name</th>

<th scope="col"> Name</th>
<th scope="col"> Email</th>

<th scope="col"> Number</th>
<th scope="col"> Designation</th>
<th scope="col"> Nationality</th>
<th scope="col"> City</th>



<th scope="col">Martial Status</th>
<th scope="col">Date</th>
<th scope="col">Time</th>

              </tr>
            </thead>
            <tbody>
                  <tr>`
                  $.each(board, function(i, item) {
                    table += `


                    <th scope="row">
                              <div class="media align-items-center">
                                <div class="media-body">
                                  <span class="mb-0 text-sm">${i+1}</span>
                                </div>
                              </div>
                            </th>



                            <th scope="row">
                            <div class="media align-items-center">
                              <div class="media-body">
                                <span class="mb-0 text-sm">${item.eventname} </span>
                              </div>
                            </div>
                          </th>
                            
                          <th scope="row">
                            <div class="media align-items-center">
                              <div class="media-body">
                                <span class="mb-0 text-sm">${item.partnername} </span>
                              </div>
                            </div>
                          </th>

                            <th scope="row">
                              <div class="media align-items-center">
                                <div class="media-body">
                                  <span class="mb-0 text-sm">${item.name} </span>
                                </div>
                              </div>
                            </th>

                            <th scope="row">
                              <div class="media align-items-center">
                                <div class="media-body">
                                  <span class="mb-0 text-sm">${item.email} </span>
                                </div>
                              </div>
                            </th>

                           
                           <th scope="row">
                              <div class="media align-items-center">
                                <div class="media-body">
                                  <span class="mb-0 text-sm">${item.number}</span>
                                </div>
                              </div>
                            </th>




                            <th scope="row">
                              <div class="media align-items-center">
                                <div class="media-body">
                                  <span class="mb-0 text-sm">${item.designation}</span>
                                </div>
                              </div>
                            </th>




                            <th scope="row">
                              <div class="media align-items-center">
                                <div class="media-body">
                                  <span class="mb-0 text-sm">${item.nationality}</span>
                                </div>
                              </div>
                            </th>



                            <th scope="row">
                              <div class="media align-items-center">
                                <div class="media-body">
                                  <span class="mb-0 text-sm">${item.city}</span>
                                </div>
                              </div>
                            </th>
      


                            <th scope="row">
                                <div class="media align-items-center">
                                  <div class="media-body">
                                    <span class="mb-0 text-sm">${item.status}</span>
                                  </div>
                                </div>
                              </th>


                              <th scope="row">
                                <div class="media align-items-center">
                                  <div class="media-body">
                                    <span class="mb-0 text-sm">${item.date}</span>
                                  </div>
                                </div>
                              </th>


                              <th scope="row">
                              <div class="media align-items-center">
                                <div class="media-body">
                                  <span class="mb-0 text-sm">${item.time}</span>
                                </div>
                              </div>
                            </th>


                  </tr>`
                  })
                  
              table +=` </tbody>
              </table>
            </div>
          </div>
        </div>
      </div>`
      $('#result').html(table)
      $('#insertdiv').hide()
      $('#result').show()
}







$('#result').on('click', '#back', function() {
    $('#result').hide()
    $('#insertdiv').show()
})


</script>


<script type="text/javascript">
    $(document).ready(function () {
$('#result').on('click', '#exportBtn1', function() {

      
          TableToExcel.convert(document.getElementById("tab1"), {
              name: "EnquiryData.xlsx",
              sheet: {
              name: "Sheet1"
              }
            });
          });
    });
  </script>

</body>

</html>